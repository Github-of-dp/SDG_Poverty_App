<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BetterLife Architect v2.0</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;800&display=swap" rel="stylesheet">
    <style>
        body { background: #050505; color: #e5e5e5; font-family: 'Plus Jakarta Sans', sans-serif; }
        .dashboard-card { 
            background: #0f0f0f; border: 1px solid #1a1a1a; border-radius: 20px; padding: 24px; 
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .dashboard-card:hover { border-color: #ccff00; transform: translateY(-4px); box-shadow: 0 10px 30px rgba(204, 255, 0, 0.05); }
        .accent-text { color: #ccff00; }
        .accent-bg { background: #ccff00; }
        input, select { background: #151515; border: 1px solid #222; color: white; padding: 12px; border-radius: 12px; width: 100%; outline: none; transition: 0.3s; }
        input:focus { border-color: #ccff00; }
        .progress-bg { background: #1a1a1a; height: 6px; border-radius: 10px; overflow: hidden; }
        .disclaimer-bar { background: #ccff00; color: black; font-weight: 800; font-size: 10px; letter-spacing: 1px; }
    </style>
</head>
<body class="p-6 md:p-10">

    <div class="max-w-7xl mx-auto">
        <div class="disclaimer-bar py-1 px-4 mb-8 rounded flex justify-between items-center">
            <span>EXPERIMENTAL SDG-1.2 SIMULATOR // MINI EDUCATIONAL PROJECT</span>
            <span>DATA FOR PROTOTYPING ONLY</span>
        </div>

        <header class="flex flex-col md:flex-row justify-between items-start mb-12 gap-6">
            <div>
                <h1 class="text-5xl font-extrabold tracking-tighter uppercase">BetterLife <span class="accent-text">Architect</span></h1>
                <p class="text-gray-500 mt-2 font-medium">Socio-Economic Intelligence Interface</p>
            </div>
            <div class="dashboard-card py-2 px-6 flex items-center gap-4">
                <span class="text-[10px] font-black text-gray-500 uppercase">Region Context</span>
                <select id="region" onchange="run()" class="border-none p-0 w-32 font-bold accent-text bg-transparent">
                    {% for r in regions %}<option value="{{ r }}">{{ r }}</option>{% endfor %}
                </select>
            </div>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
            <div class="lg:col-span-4 space-y-6">
                <div class="dashboard-card">
                    <h3 class="text-xs font-black text-gray-500 uppercase mb-6 tracking-widest">Core Variables</h3>
                    <div class="space-y-5">
                        <div>
                            <label class="text-[10px] font-bold text-gray-400 uppercase mb-2 block">Monthly Income</label>
                            <input type="number" id="income" value="10000" oninput="run()">
                        </div>
                        <div>
                            <label class="text-[10px] font-bold text-gray-400 uppercase mb-2 block">Education Years</label>
                            <input type="number" id="edu" value="12" oninput="run()">
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="text-[10px] font-bold text-gray-400 uppercase mb-2 block">Family Size</label>
                                <input type="number" id="h_size" value="4" oninput="run()">
                            </div>
                            <div>
                                <label class="text-[10px] font-bold text-gray-400 uppercase mb-2 block">Workers</label>
                                <input type="number" id="workers" value="1" oninput="run()">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="dashboard-card border-l-4 border-[#ccff00]">
                    <h3 class="text-xs font-black accent-text uppercase mb-2 tracking-widest">Target 1.2 Analysis</h3>
                    <p class="text-xs text-gray-400 leading-relaxed italic">
                        "Reduce by half the proportion of people living in poverty in all its dimensions." Our AI maps deprivations in health, education, and living standards.
                    </p>
                    <div class="mt-4 p-2 bg-[#ccff00]/5 rounded text-[10px] font-bold accent-text" id="target_label">SDG 1.2.1 Tracking</div>
                </div>
            </div>

            <div class="lg:col-span-8 grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="dashboard-card md:col-span-2 flex flex-col md:flex-row justify-between items-center relative overflow-hidden">
                    <div class="z-10 text-center md:text-left">
                        <h4 class="text-sm font-bold text-gray-500 uppercase mb-1">Vulnerability Index</h4>
                        <div class="text-8xl font-black accent-text" id="risk_val">0%</div>
                        <div class="mt-2 inline-block px-4 py-1 rounded-full bg-white/5 text-[10px] font-black uppercase tracking-widest" id="status">Loading</div>
                    </div>
                    <div class="w-full md:w-1/2 mt-8 md:mt-0 space-y-4 z-10" id="breakdown_box">
                        </div>
                    <div class="absolute inset-0 opacity-[0.03] pointer-events-none" style="background-image: radial-gradient(#ccff00 1px, transparent 1px); background-size: 20px 20px;"></div>
                </div>

                <div class="dashboard-card md:col-span-2">
                    <h4 class="text-xs font-black text-gray-500 uppercase mb-4 tracking-widest">Architectural Recommendations</h4>
                    <div id="recs" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        </div>
                </div>
            </div>
        </div>

        <footer class="mt-12 pt-8 border-t border-white/5 text-[9px] text-gray-600 text-center leading-relaxed">
            DISCLAIMER: This tool is for educational purposes as part of a school/mini project. It utilizes simplified socio-economic weighting logic and does not constitute financial, legal, or social welfare advice. Data reflects simulated SDG-1.2 monitoring frameworks.
        </footer>
    </div>

    <script>
        async function run() {
            const data = {
                income: document.getElementById('income').value,
                education: document.getElementById('edu').value,
                h_size: document.getElementById('h_size').value,
                workers: document.getElementById('workers').value,
                region: document.getElementById('region').value
            };

            const res = await fetch('/analyze', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify(data)
            });
            const r = await res.json();

            // Main Display
            document.getElementById('risk_val').innerText = r.risk + "%";
            document.getElementById('status').innerText = r.status;
            document.getElementById('target_label').innerText = r.target_info;

            // Breakdown Bars
            const bbox = document.getElementById('breakdown_box');
            bbox.innerHTML = '';
            r.breakdown.forEach(item => {
                bbox.innerHTML += `
                    <div>
                        <div class="flex justify-between text-[10px] font-black uppercase mb-1">
                            <span>${item.label}</span>
                            <span class="accent-text">${item.val}%</span>
                        </div>
                        <div class="progress-bg"><div class="h-full accent-bg transition-all duration-1000" style="width:${item.val}%"></div></div>
                        <p class="text-[9px] text-gray-600 mt-1 italic">${item.desc}</p>
                    </div>
                `;
            });

            // Recs
            const rbox = document.getElementById('recs');
            rbox.innerHTML = '';
            r.breakdown.forEach(item => {
                if(item.val > 15) {
                    rbox.innerHTML += `
                        <div class="p-4 bg-white/5 rounded-xl border border-white/5">
                            <div class="text-[10px] font-black accent-text uppercase mb-1">Fix: ${item.label}</div>
                            <p class="text-xs text-gray-400">System detected high variance. Focus on reducing this specific deprivation to meet SDG 1.2 goals.</p>
                        </div>
                    `;
                }
            });
        }
        window.onload = run;
    </script>
</body>
</html>
